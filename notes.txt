Een message heeft altijd een 'type' en een 'body' key)

Twee 'type' soorten:
- Protocol
    Wordt gebruikt om de server iets te laten doen of door de server om de client iets te laten weten.

    * Een protocol heeft altijd een 'action' key. Moet een string zijn.
    Type actions: subscribe, unsubscribe

    * De 'body' key moet altijd een dictionary zijn. Hierin staat eventuele data voor de protocolactie.


    Subscriben op een event
    Voorbeeld 'subscribe' message (verstuurd door client):
    {
        "type": "protocol",
        "action": "subscribe",
        "body": {"events": ["massurltask"]}
    }

    Unsubscriben van een event
    Voorbeeld 'unsubscribe' message (verstuurd door client):
    {
        "type": "protocol",
        "action": "unsubscribe",
        "body": {"events": ["massurltask"]}
    }

    Verstuurd de server als hij gesloten wordt. De server onthoudt niet de subscriptions na het sluiten.
    (Cuckoo EventClient stuurt de subscriptions meteen weer op na een disconnect van de serverkant)
    Voorbeeld 'serverclose' message (verstuurd door server):
    {
        "type": "protocol",
        "action": "serverclose",
        "body": {}
    }

    De server verstuurd een 'notwhitelisted' bericht als het IP dat verbindt met de server niet whitelisted is.
    Na het versturen van het bericht, sluit de server de verbinding.
    Voorbeeld 'notwhitelisted' message (verstuurd door server):
    {
        "type": "protocol",
        "action": "serverclose",
        "body": {"ip": "8.8.8.8"}
    }

- Event
    Dit is een bericht dat door een andere client is verstuurd en kan verstuurd of ontvangen worden.
    De 'body' key van het bericht heeft het type event. Een event moet zelf ook een 'body' key hebben

    Een voorbeeld van een event dat binnenkomt: (De analysis manager start in dit geval)

    voorbeeld 1
    {
        "type": "event",
        "body": {
            "event": "massurltask",
            "body": {
               "status": "starting"
            }
        }
    }

    voorbeeld 2 (Een nieuwe set van X URLs wordt geopend in de VM)
    {
        "type": "event",
        "body": {
            "event": "massurltask",
            "body": {
               "taskid": 1,
               "status": "running",
               "action": "newbatch"
            }
        }
    }

    voorbeeld 3 (De batch van X URLs is nu gesloten.. Hierna volgt weer een voorbeeld 2 bericht of task status update)
    {
        "type": "event",
        "body": {
            "event": "massurltask",
            "body": {
               "taskid": 1,
               "status": "running",
               "action": "batchclosed"
            }
        }
    }

    voorbeeld 4 (De taak is gestopt)
    {
        "type": "event",
        "body": {
            "event": "massurltask",
            "body": {
               "taskid": 1,
               "status": "stopped"
            }
        }
    }
