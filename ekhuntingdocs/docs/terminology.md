# Mass URL terminology/components

The section is a collection of all used Mass URL terminology. It explains, in short, what a term means/what it does.

**URL Group**

A named group to which one or more(potentially 100k+) URLs belong. A group can be scheduled to be analyed every X days, a specific day or immediately. A group has settings that affect how a group is analyzed. 

- Threshold/max_parallel is the maximum amount of URLs the Mass URL scheduler will add to a task when scheduling a group.
- The batch size determines how many URLs are opened at the same time inside the VM.
- The batch timeout determines how long a batch remains opened before the next batch is opened.


**Alert**

An alert is an event that is sent by the Mass URL scheduler to the dashboard. It has a level of severeness from 1 to 3. Level 3 alerts are used for detections by the real-time kernel event processor.
Alerts can contain references to URL diaries and PCAP files containing traffic related to the generated alert.

**URL Diary**

A JSON document containing the URLs to which network requests were made, potentially interesting executed javascript (IE8 and IE11 only), and the triggered real-time processor signatures and matching IOCs. Each network request URL has a reference to a request log. A new URL diary is created each time a URL is analyzed.

**Request log**

A JSON document containing all requests and the responses for to a URL generated by a page that is analyzed. A request log has a parent id, which is a UUID of the URL diary.

**Kernel monitor/onemon**

The Windows kernel monitor developed by Hatching BV, which is loaded inside the analysis VM upon a new analysis. The monitor is responsible for tracking events such as created processes and netflows. These events are all sent to a onemon.pb file, which is processed in real-time by the real-time processor.

**Real-time processor**

Processes events from the onemon.pb file. It contains 'real-time signatures' that, if triggered, sent out an event indicating the triggered signature and IOCs. This event is received by multiple components, one of which is the Mass URL scheduler. The scheduler sends out a level 3 alert to the operator dashboard.

**Analysis replay**

A Cuckoo feature that uses patched versions of mitmproxy to start a server that serves the network requests captured during an analysis. It is used to try and see what URL/webpage caused a detection to happen in case more than one URL was opened in the VM during a detection.

**Event server**

An event messaging server located in Cuckoo Mass URL. It allows clients to subscribe to specific named events and to send these events. Components such as the real-time processor, the Mass URL scheduler, and analysis manager use it to exchange information.

**Mass URL scheduler**

The component responsible for keeping track of when tasks for a URL group should be created and keeping track of created tasks. Upon receiving detection events, it will send out an alert to the dashboard and make sure that URLs in the task that had a detection are analyzed if any unanalyzed URLs remain. Lastly, it runs custom URL diary signatures and cleanup/retention.

**Mass URL analysis manager**

The component that is responsible for the analysis flow. It will start a VM, upload the URL in batches and stop them after a timeout. It communicates with the real-time processor to extract event data and to be able to attribute network requests and executed javascript. It populates and stores the URL diaries after a URL has been analyzed.

